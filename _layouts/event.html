<!DOCTYPE html>
<html lang="en" class="h-100">
<head>
{% include head.html %}
	{% if page.cover %}
<meta property="og:image" content="{{ page.cover | absolute_url }}">
<meta name="twitter:image" content="{{ page.cover | absolute_url }}">
{% endif %}
</head>
	
<style>
    .parallax-hero {
      background-attachment: fixed;
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      height: 60vh;
      position: relative;
    }
    @media (max-width: 768px) {
      .parallax-hero { background-attachment: scroll; }
    }
    .event-content p { margin-bottom: 1rem; }
    .event-content h2, .event-content h3 { margin-top: 2rem; }
    .map-responsive iframe { width: 100%; height: 100%; border: 0; }
  </style>
	
<body>
{% include header.html %}
<div id="top"></div>
{% if page.cover %} 
<!-- Hero Cover Section -->
<section class="parallax-hero" style="background-image: url('{{ page.cover | relative_url }}');" >
  <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark bg-opacity-50"></div>
  <div class="container h-100 d-flex flex-column justify-content-center align-items-center text-white position-relative text-center">
    <h1 class="display-4 fw-bold animate__animated animate__fadeInDown">{{ page.title }}</h1>
    <p class="lead animate__animated animate__fadeInUp animate__delay-1s"> {{ page.date | date: "%B %-d, %Y" }}{% if page.location %} &mdash; {{ page.location }}{% endif %} </p>
    {% if page.tags %}
    <div class="mt-3"> {% for tag in page.tags %} <span class="badge bg-primary me-1">#{{ tag }}</span> {% endfor %} </div>
    {% endif %} </div>
</section>
{% endif %}
<main id="mainContent" class="p-5 pt-2" data-aos="fade-up"> {% unless page.cover %}
  <h1 class="mb-3">{{ page.title }}</h1>
  <p class="text-muted"> {{ page.date | date: "%B %-d, %Y" }}{% if page.location %} &mdash; {{ page.location }}{% endif %} </p>

{% endunless%}	
  
  <div class="d-flex flex-wrap gap-2 mb-4"> {% if page.registration_url %} <a href="{{ page.registration_url }}" class="btn btn-sm btn-outline-primary fw-semibold animate__animated animate__pulse animate__infinite" target="_blank"> <i class="fa-solid fa-calendar-check me-1"></i> Register Now </a> {% endif %} <a class="btn btn-sm btn-outline-dark fw-semibold" target="_blank"
     href="https://www.google.com/calendar/render?action=TEMPLATE&text={{ page.title | uri_escape }}&dates={{ page.date | date: '%Y%m%d' }}T{{ page.start_time | remove: ':' }}00/{{ page.date | date: '%Y%m%d' }}T{{ page.end_time | remove: ':' }}00&details={{ page.content | strip_html | uri_escape }}&location={{ page.location | uri_escape }}"> <i class="fa-solid fa-calendar-plus me-1"></i> Add to Calendar </a> <a class="btn btn-sm btn-outline-info fw-semibold" download="{{ page.title | slugify }}.ics"
     href="data:text/calendar;charset=utf8,BEGIN:VCALENDAR%0AVERSION:2.0%0ABEGIN:VEVENT%0ASUMMARY:{{ page.title | uri_escape }}%0ADTSTART:{{ page.date | date: '%Y%m%d' }}{{ page.start_time | remove: ':' }}00Z%0ADTEND:{{ page.date | date: '%Y%m%d' }}{{ page.end_time | remove: ':' }}00Z%0ADESCRIPTION:{{ page.content | strip_html | uri_escape }}%0ALOCATION:{{ page.location | uri_escape }}%0AEND:VEVENT%0AEND:VCALENDAR"> <i class="fa-solid fa-file-export me-1"></i> Download .ICS </a>
    <button class="btn btn-sm btn-outline-secondary fw-semibold ms-auto"
          onclick="navigator.share ? navigator.share({ title: '{{ page.title }}', url: '{{ page.url | absolute_url }}' }) : alert('Share not supported on this browser.')"> <i class="fa-solid fa-share-nodes me-1"></i> Share </button>
  </div>	
	
<div class="row align-items-start mb-4">
  {% if page.content %}
  <div class="col-12 col-md-8 mb-3 mb-md-0">
    <div class="event-content">{{ page.content | markdownify }}</div>
  </div>
  {% endif %}

  {% if page.map_embed %}
  <div class="col-12 col-md-4 d-flex justify-content-center">
    <div class="map-responsive ratio ratio-4x3 w-100" style="max-width:400px;">
      {{ page.map_embed | raw }}
    </div>
  </div>
  {% endif %}
</div>

	
{% if page.image_gallery %}
  {% assign imgs = page.image_gallery %}
  <div id="eventCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
    <div class="carousel-inner">
      {% for img in imgs %}
        <div class="carousel-item {% if forloop.first %}active{% endif %} position-relative">
          <div class="card shadow-sm">

            <div class="ratio ratio-4x3">
              <img
                src="{{ img.img }}"
                class="card-img-top object-fit-cover"
                alt="{{ img.caption }}">
            </div>

            {% if img.caption %}
              <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded px-2 py-1 position-absolute bottom-0 start-50 translate-middle-x mb-2" style="max-width: 90%; font-size: 0.9rem;">
                {{ img.caption }}
              </div>
            {% endif %}

          </div>
        </div>
      {% endfor %}
    </div>

    <button class="carousel-control-prev" type="button" data-bs-target="#eventCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#eventCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
{% endif %}


{% assign events_sorted = site.events | sort: 'date' %}
{% assign current_url = page.url %}
{% assign idx = -1 %}

{% for e in events_sorted %}
  {% if e.url == current_url %}
    {% assign idx = forloop.index0 %}
    {% break %}
  {% endif %}
{% endfor %}

{%- comment -%} Previous events: all before current {% endcomment %}
{% assign prev_candidates = events_sorted | slice: 0, idx %}
{% assign prev_candidates_rev = prev_candidates | reverse %}
{% assign prev = nil %}

{% for e in prev_candidates_rev %}
  {% if e.url != current_url %}
    {% assign prev = e %}
    {% break %}
  {% endif %}
{% endfor %}

{%- comment -%} Next events: all after current {% endcomment %}
{% assign next_start = idx | plus: 1 %}
{% assign next_length = events_sorted.size | minus: next_start %}
{% assign next_candidates = events_sorted | slice: next_start, next_length %}
{% assign next = nil %}

{% for e in next_candidates %}
  {% if e.url != current_url %}
    {% assign next = e %}
    {% break %}
  {% endif %}
{% endfor %}

<div class="d-flex justify-content-between align-items-center mt-5 pt-4 pb-4 border-top gap-3">
  {% if prev %}
    <a href="{{ prev.url }}" class="btn btn-outline-secondary btn-sm"> ← {{ prev.title | truncate: 25, '…' }} </a>
  {% else %}
    <button class="btn btn-outline-secondary btn-sm" disabled> ← No Previous </button>
  {% endif %}

  <a href="/events-and-activities/" class="btn btn-outline-dark btn-sm">
    <i class="fa-solid fa-list me-1"></i> View All Events
  </a>

  {% if next %}
    <a href="{{ next.url }}" class="btn btn-outline-secondary btn-sm"> {{ next.title | truncate: 25, '…' }} → </a>
  {% else %}
    <button class="btn btn-outline-secondary btn-sm" disabled> No Next → </button>
  {% endif %}
</div>
</main>
<!-- CTA -->
{% include register.html %}	
	
{% include footer.html %}
{% include scripts.html %} 
<a id="btnTop" href="#top" class="btn btn-secondary shadow position-fixed bottom-0 end-0 m-3 z-3" data-aos="fade-up" aria-label="Back to top"> <i class="fa-solid fa-arrow-up"></i> </a>

  {% include cookie-consent.html %}

</body>
<!-- Events page -->
<script src="/js/events.js" defer></script>
</html>